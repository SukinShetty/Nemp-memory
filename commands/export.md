---
description: "Export memories to CLAUDE.md for persistent project context"
argument-hint: "[--replace]"
---

# /nemp:export

Export all project memories to CLAUDE.md in a clean, readable format.

## Usage
```
/nemp:export           # Append or update Nemp section in CLAUDE.md
/nemp:export --replace # Replace entire CLAUDE.md with Nemp content only
```

## Arguments
- `--replace` (optional): Replace the entire CLAUDE.md instead of appending/updating

## Instructions

When the user invokes `/nemp:export`, follow these steps:

### 1. Load Project Memories

Read the project memories file:

```bash
[ -f ".nemp/memories.json" ] && cat .nemp/memories.json
```

If no memories exist, inform the user:
```
âŒ No memories to export.

Save some memories first:
  /nemp:save stack Next.js 15 with TypeScript
  /nemp:init  (auto-detect project stack)
```

### 2. Parse and Organize Memories

Group memories by tags if they exist. Common groupings:
- **Tech Stack**: keys containing `stack`, `framework`, `database`, `auth`, `styling`
- **Project Info**: keys containing `project`, `description`, `structure`
- **Preferences**: keys containing `prefer`, `style`, `convention`
- **Other**: everything else

### 3. Generate Markdown Content

Create a clean, professional markdown section:

```markdown
## Project Context (via Nemp Memory)

> Auto-generated by Nemp Memory. Last updated: [YYYY-MM-DD HH:MM]

| Key | Value |
|-----|-------|
| **stack** | Next.js 15, TypeScript, Prisma, PostgreSQL |
| **auth** | NextAuth with JWT |
| **styling** | Tailwind CSS v4 |
| **database** | Prisma ORM with PostgreSQL |

---
```

For memories with longer values, use a different format:

```markdown
## Project Context (via Nemp Memory)

> Auto-generated by Nemp Memory. Last updated: [YYYY-MM-DD HH:MM]

**stack:** Next.js 15, TypeScript, Prisma, PostgreSQL

**auth:** NextAuth with JWT tokens stored in httpOnly cookies

**project-description:** A SaaS starter kit for building subscription-based applications with built-in auth, payments, and admin dashboard.

**structure:**
- Commands defined in /commands/*.md
- Plugin config in .claude-plugin/
- Hooks in .claude-plugin/hooks/

---
```

Use the table format for short values (< 80 chars) and the list format for longer values.

### 4. Check for Existing CLAUDE.md

```bash
[ -f "CLAUDE.md" ] && cat CLAUDE.md
```

### 5. Handle CLAUDE.md Updates

**If CLAUDE.md does NOT exist:**
- Create a new file with just the Nemp section

**If CLAUDE.md exists and contains a Nemp section:**
- Look for `## Project Context (via Nemp Memory)` heading
- Find the end of the Nemp section (next `## ` heading or `---` separator or end of file)
- Replace ONLY that section with the updated content
- Preserve all other content in the file

**If CLAUDE.md exists but has NO Nemp section:**
- Append the Nemp section at the end of the file
- Add a blank line before the section for clean separation

### 6. Write to CLAUDE.md

Use the Write tool to save the updated content.

### 7. Confirm to User

Display a summary:

```
âœ… Exported to CLAUDE.md

   Memories exported: 5
   File: ./CLAUDE.md

   Exported keys:
   â€¢ stack
   â€¢ auth
   â€¢ styling
   â€¢ database
   â€¢ project-description

ðŸ’¡ CLAUDE.md is automatically read by Claude Code at session start.
```

## Example

User: `/nemp:export`

Given these memories in `.nemp/memories.json`:
```json
{
  "stack": {
    "value": "Next.js 15 with TypeScript, Prisma, PostgreSQL",
    "created": "2024-01-20T10:00:00Z",
    "updated": "2024-01-20T10:00:00Z"
  },
  "auth": {
    "value": "NextAuth with JWT",
    "created": "2024-01-20T10:00:00Z",
    "updated": "2024-01-20T10:00:00Z"
  }
}
```

Creates/updates CLAUDE.md:
```markdown
## Project Context (via Nemp Memory)

> Auto-generated by Nemp Memory. Last updated: 2024-01-20 10:00

**stack:** Next.js 15 with TypeScript, Prisma, PostgreSQL

**auth:** NextAuth with JWT

---
```

Response:
```
âœ… Exported to CLAUDE.md

   Memories exported: 2
   File: ./CLAUDE.md

   Exported keys:
   â€¢ stack
   â€¢ auth

ðŸ’¡ CLAUDE.md is automatically read by Claude Code at session start.
```

## Section Detection Logic

To find and replace an existing Nemp section:

1. Search for the line: `## Project Context (via Nemp Memory)`
2. Find where the section ends:
   - Next heading starting with `## ` (but not the Nemp heading itself)
   - Or a line containing only `---`
   - Or end of file
3. Replace everything between start and end with new content
4. Preserve exact whitespace and formatting of surrounding content

## Error Handling

- **No memories**: Prompt user to save memories first
- **Write permission error**: Report error and suggest checking file permissions
- **Malformed memories.json**: Report parsing error and suggest checking the file

## Tips

After exporting, remind the user:
- CLAUDE.md is read automatically by Claude Code
- Run `/nemp:export` again after adding new memories
- Use `/nemp:list` to see all available memories
